<!-- views/characters/relationship-gallery.ejs -->
<div class="d-flex justify-between align-center mb-4">
  <h1>Relationship Gallery</h1>
  <div>
    <a href="/characters/relationships/<%= relationship.id %>/gallery/add" class="btn btn-sm mr-2">
      <i class="ph-image-plus-duotone"></i> Add Image
    </a>
    <a href="/characters/relationships/view/<%= relationship.id %>" class="btn btn-sm btn-outline">
      <i class="ph-arrow-left-duotone"></i> Back to Relationship
    </a>
  </div>
</div>

<div class="card mb-4">
  <div class="card-header">
    <h3 class="mb-0"><%= relationship.character1.name %> & <%= relationship.character2.name %>'s Gallery</h3>
  </div>
  <div class="card-body">
    <% if (typeof galleryImages !== 'undefined' && galleryImages.length > 0) { %>
      <div class="image-gallery">
        <% galleryImages.forEach(image => { %>
          <div class="gallery-item" data-id="<%= image.id %>">
            <div class="gallery-image-container">
              <img src="<%= image.imageUrl %>" alt="Gallery Image" class="gallery-image">
              <div class="gallery-image-actions">
                <form action="/characters/relationships/<%= relationship.id %>/gallery/<%= image.id %>?_method=DELETE" method="POST">
                  <button type="submit" class="btn btn-sm btn-danger delete-confirm">
                    <i class="ph-trash-duotone"></i>
                  </button>
                </form>
              </div>
              <div class="gallery-image-uploader">
                <small>Added by <%= image.uploader.username %></small>
              </div>
            </div>
            <% if (image.caption) { %>
              <div class="gallery-image-caption">
                <%= image.caption %>
              </div>
            <% } %>
          </div>
        <% }); %>
      </div>
      
      <% if (galleryImages.length > 1) { %>
        <div class="text-center mt-4">
          <button id="reorderBtn" class="btn btn-sm">
            <i class="ph-arrows-out-duotone"></i> Reorder Images
          </button>
          <button id="saveOrderBtn" class="btn btn-sm btn-success" style="display: none;">
            <i class="ph-check-duotone"></i> Save Order
          </button>
          <button id="cancelOrderBtn" class="btn btn-sm btn-outline" style="display: none;">
            <i class="ph-x-duotone"></i> Cancel
          </button>
        </div>
      <% } %>
    <% } else { %>
      <div class="text-center p-4">
        <p class="mb-3">No images have been added to the gallery yet.</p>
        <a href="/characters/relationships/<%= relationship.id %>/gallery/add" class="btn">
          <i class="ph-image-plus-duotone"></i> Add Your First Image
        </a>
      </div>
    <% } %>
  </div>
</div>

<!-- Image viewer modal -->
<div id="imageViewerModal" class="modal" style="display: none;">
  <div class="modal-content gallery-modal">
    <span class="close-modal" id="closeImageViewer">
      <i class="ph-x-duotone"></i>
    </span>
    <div class="image-viewer-container">
      <img id="viewerImage" src="" alt="Gallery Image">
    </div>
    <div class="image-viewer-caption" id="viewerCaption"></div>
  </div>
</div>

<style>
  .image-gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 20px;
  }
  
  .gallery-item {
    transition: transform 0.3s ease;
    cursor: pointer;
    position: relative;
  }
  
  .gallery-item:hover {
    transform: scale(1.03);
  }
  
  .gallery-image-container {
    position: relative;
    overflow: hidden;
    border-radius: var(--radius-md);

  }